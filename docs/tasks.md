# 実装計画

- [ ] 1. プロジェクト初期設定とコア構造の構築
  - Flutterプロジェクトの作成と基本設定
  - Dart分析オプションとlintルールの設定
  - 必要なパッケージのインストール（provider/riverpod、shared_preferences/hive、in_app_purchase、google_mobile_ads）
  - プロジェクトフォルダ構造の作成（screens、widgets、services、models、assets）
  - _要件: 6.1, 6.2, 6.3_

- [ ] 2. 基本的なデータモデルとクラスの定義
  - Dartクラスの実装（StoryData、Chapter、Scene、Choice、UserProgress）
  - エラーハンドリング用のクラス定義
  - テスト用のモックデータ作成
  - JSON シリアライゼーション/デシリアライゼーション
  - _要件: 1.1, 3.1, 5.1_

- [ ] 3. ローカルストレージサービスの実装
  - SharedPreferences/Hiveを使用したデータ永続化サービスの作成
  - ユーザー進捗の保存・読み込み機能
  - 設定データの管理機能
  - エラーハンドリングとデータ検証の実装
  - ユニットテストの作成
  - _要件: 1.3, 5.4_

- [ ] 4. 物語エンジンのコア機能実装
  - 物語データの読み込み機能
  - シーン遷移ロジックの実装
  - 選択肢処理とブランチング機能
  - 進捗追跡機能
  - ユニットテストの作成
  - _要件: 1.1, 1.2, 1.3, 5.4_

- [ ] 5. 基本画面ウィジェットの作成
  - タイトル画面ウィジェットの実装
  - 物語選択画面ウィジェットの実装
  - 物語進行画面ウィジェットの実装
  - 基本的なナビゲーション設定（Navigator 2.0）
  - _要件: 3.1, 3.2, 3.3_

- [ ] 6. 物語進行画面の詳細実装
  - テキスト表示ウィジェットの実装
  - 選択肢ボタンの動的生成と処理
  - 進捗インジケーターの表示
  - 画面遷移とアニメーションの実装
  - _要件: 1.1, 1.2, 1.3_

- [ ] 7. サポート機能（知恵袋）の実装
  - サポート機能モーダルウィジェットの作成
  - TabBarView を使用したタブ切り替え機能（人物/用語/地図）
  - 解説コンテンツの表示機能
  - 検索・フィルタリング機能
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [ ] 8. 坂本龍馬物語のコンテンツ実装
  - 幕末・坂本龍馬の物語データ作成（JSON形式）
  - 登場人物データの作成（勝海舟、中岡慎太郎、西郷隆盛、お龍など）
  - 用語集データの作成
  - 複数の選択肢と結末の実装
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [ ] 9. 広告システムの統合
  - Google Mobile Ads SDK for Flutterの設定と初期化
  - 章の合間での広告表示機能
  - 広告読み込みエラーのハンドリング
  - 広告表示のタイミング制御
  - _要件: 4.1_

- [ ] 10. アプリ内課金機能の実装
  - in_app_purchaseパッケージの設定
  - 広告非表示オプションの購入処理
  - レシート検証とエラーハンドリング
  - 購入状態の永続化
  - _要件: 4.2, 4.3_

- [ ] 11. 課金案内画面の実装
  - 課金案内画面ウィジェットの作成
  - 広告非表示オプションの説明表示
  - 購入ボタンと価格表示
  - 購入フローの統合
  - _要件: 4.4_

- [ ] 12. エラーハンドリングとユーザーフィードバック
  - グローバルエラーハンドラーの実装
  - ユーザーフレンドリーなエラーメッセージ
  - ローディング状態の表示（CircularProgressIndicator等）
  - ネットワークエラー対応
  - _要件: 全般的なエラーハンドリング_

- [ ] 13. 統合テストとE2Eテスト
  - 主要な画面遷移のテスト（Flutter Integration Test）
  - 物語進行フローのテスト
  - 課金処理のテスト
  - 広告表示のテスト
  - _要件: 全要件の統合テスト_

- [ ] 14. パフォーマンス最適化
  - メモリ使用量の最適化
  - レンダリングパフォーマンスの改善
  - アプリ起動時間の短縮
  - バッテリー消費の最適化
  - _要件: 6.4_

- [ ] 15. アプリストア申請準備
  - アプリアイコンとスプラッシュスクリーンの作成
  - App Store/Google Play用のメタデータ準備
  - プライバシーポリシーと利用規約の作成
  - アプリ署名とビルド設定
  - _要件: 6.1, 6.2_